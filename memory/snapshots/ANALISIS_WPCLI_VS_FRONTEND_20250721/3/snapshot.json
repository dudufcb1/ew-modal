{
  "schema_version": "2.0.0",
  "meta": {
    "task_id": "ANALISIS_WPCLI_VS_FRONTEND_20250721",
    "status": "done",
    "revision": 3,
    "snapshot_id": "b3430ad4-56c3-49df-a949-af7329690434",
    "date": "2025-07-21T11:45:00Z",
    "project": "ewm-modal-cta",
    "author": "augment_agent",
    "group_id": "investigacion_ewm_modal_builder",
    "can_agent_set_done": true,
    "rolled_back": false,
    "timestamp": "2025-07-21T18:03:21.828879Z",
    "group_md": "groups/investigacion_ewm_modal_builder/group.md"
  },
  "scope": {
    "files": [
      "assets/js/modal-admin.js",
      "includes/class-ewm-rest-api.php",
      "includes/class-ewm-admin-page.php",
      "includes/class-ewm-render-core.php"
    ],
    "components": [
      "Modal Admin JS",
      "REST API",
      "Admin Page AJAX",
      "Render Core"
    ],
    "affected_files": [
      "includes/class-ewm-admin-page.php",
      "includes/class-ewm-render-core.php"
    ]
  },
  "problem": {
    "user_request": "Analizar por qué hardcodear datos con WP CLI funciona pero el guardado desde frontend se resetea al estado de BD",
    "description": "WP CLI nativo inserta datos correctamente, pero panel admin no persiste cambios",
    "root_cause": "Conflicto entre sistema de carga AJAX legacy y sistema de guardado REST API unificado",
    "evidence": [
      "WP CLI nativo: wp post meta update 123 'ewm_modal_config' '{...}' funciona",
      "Panel Admin: Guarda vía REST API en ewm_modal_config",
      "Panel Admin: Carga vía AJAX que usa sistema legacy",
      "load_modal_builder() usa get_modal_data() que NO lee ewm_modal_config",
      "Render Core lee ewm_modal_config pero hace fallback a legacy"
    ]
  },
  "solution": {
    "approach": "Unificar sistema de carga para que use ewm_modal_config",
    "steps": [
      "Modificar load_modal_builder() para leer de ewm_modal_config",
      "Asegurar que get_modal_data() use sistema unificado",
      "Eliminar fallback legacy en render core",
      "Testing del flujo completo: guardar -> recargar -> verificar"
    ],
    "expected_outcome": "Panel admin persiste cambios correctamente como WP CLI"
  }
}